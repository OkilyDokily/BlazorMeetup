@using BlazorMeetup.Data
@inject UserManager<Attendee> UserManager
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject MeetupService MeetupService
@inject UserManager<Attendee> UserManager
@inject NavigationManager NavigationManager

@if (EventId != "" && EventId != null)
{
    <CascadingValue Value="this">
        <TabControl IsActiveControl=@EventPageIsActive>
            <TabPage Text="Main">
                <MainEvent CurrentEvent=@CurrentEvent />
            </TabPage>

            <TabPage Text="Suggest a time for available dates">
                <SuggestDate />
            </TabPage>

            @if (DbUserId != null && CurrentEvent != null && DbUserId == CurrentEvent.AttendeeId)
        {
            <TabPage Text="Assign User To Teams">
                <AssignTeams EventId=@EventId />
            </TabPage>
        }
        else
        {
            <TabPage Text="See who is on which team">
                <ShowTeams />
            </TabPage>
        }
    </TabControl>
</CascadingValue>
}

@code {


    [CascadingParameter(Name = "DbUserId")]
    public string DbUserId { get; set; }
    [Parameter]
    public string EventId { get; set; }
    [Parameter]
    public bool EventPageIsActive { get; set; } = true;
    public Event CurrentEvent { get; set; }


    protected override void OnParametersSet()
    {
        CurrentEvent = MeetupService.GetEventById(EventId);
    }

}
